{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/ken/dev/CommitPoolMatic/CommitPoolApp/MakeCommitment.tsx\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport { ethers, utils } from 'ethers';\nimport abi from \"./abi.json\";\nimport daiAbi from \"./daiAbi.json\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport DropDownPicker from 'react-native-dropdown-picker';\n\nvar MakeCommitment = function (_Component) {\n  _inherits(MakeCommitment, _Component);\n\n  var _super = _createSuper(MakeCommitment);\n\n  function MakeCommitment(props) {\n    var _this;\n\n    _classCallCheck(this, MakeCommitment);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      distance: 0,\n      stake: 0,\n      loading: false,\n      txSent: false,\n      activity: {},\n      activities: []\n    };\n    return _this;\n  }\n\n  _createClass(MakeCommitment, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var url, provider, privateKey, wallet, contractAddress, contract, daiAddress, daiContract, activities, exists, index, key, activity, clone, formattedActivities;\n      return _regeneratorRuntime.async(function componentDidMount$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              url = 'https://rpc-mumbai.maticvigil.com/v1/e121feda27b4c1387cd0bf9a441e8727f8e86f56';\n              provider = new ethers.providers.JsonRpcProvider(url);\n              privateKey = this.props.account.signingKey.privateKey;\n              wallet = new ethers.Wallet(privateKey);\n              wallet = wallet.connect(provider);\n              contractAddress = '0x251B6f95F6A17D2aa350456f616a84b733380eBE';\n              contract = new ethers.Contract(contractAddress, abi, provider);\n              daiAddress = '0x70d1f773a9f81c852087b77f6ae6d3032b02d2ab';\n              daiContract = new ethers.Contract(daiAddress, daiAbi, provider);\n              this.contract = contract.connect(wallet);\n              this.daiContract = daiContract.connect(wallet);\n              activities = [];\n              exists = true;\n              index = 0;\n\n            case 14:\n              if (!exists) {\n                _context.next = 34;\n                break;\n              }\n\n              _context.prev = 15;\n              _context.next = 18;\n              return _regeneratorRuntime.awrap(this.contract.activityKeyList(index));\n\n            case 18:\n              key = _context.sent;\n              _context.next = 21;\n              return _regeneratorRuntime.awrap(this.contract.activities(key));\n\n            case 21:\n              activity = _context.sent;\n              clone = _extends({}, activity);\n              clone.key = key;\n              activities.push(clone);\n              index++;\n              _context.next = 32;\n              break;\n\n            case 28:\n              _context.prev = 28;\n              _context.t0 = _context[\"catch\"](15);\n              console.log(_context.t0);\n              exists = false;\n\n            case 32:\n              _context.next = 14;\n              break;\n\n            case 34:\n              formattedActivities = activities.map(function (act) {\n                if (act[0] === 'Run') {\n                  return {\n                    label: 'Run üèÉ‚Äç‚ôÇÔ∏è',\n                    value: act.key\n                  };\n                } else if (act[0] === 'Ride') {\n                  return {\n                    label: 'Ride üö≤',\n                    value: act.key\n                  };\n                } else {\n                  return {\n                    label: act[0],\n                    value: act.key\n                  };\n                }\n              });\n              this.setState({\n                activities: formattedActivities,\n                activity: formattedActivities[0]\n              });\n\n            case 36:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, [[15, 28]], Promise);\n    }\n  }, {\n    key: \"createCommitment\",\n    value: function createCommitment() {\n      var distanceInMiles, startTime, stakeAmount, allowance;\n      return _regeneratorRuntime.async(function createCommitment$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              distanceInMiles = Math.floor(this.state.distance);\n              startTime = Math.ceil(new Date().getTime() / 1000) + 60;\n              stakeAmount = utils.parseEther(this.state.stake.toString());\n              this.setState({\n                loading: true\n              });\n              _context2.next = 6;\n              return _regeneratorRuntime.awrap(this.daiContract.allowance(this.props.account.signingKey.address, '0x251B6f95F6A17D2aa350456f616a84b733380eBE'));\n\n            case 6:\n              allowance = _context2.sent;\n\n              if (!allowance.gte(stakeAmount)) {\n                _context2.next = 12;\n                break;\n              }\n\n              _context2.next = 10;\n              return _regeneratorRuntime.awrap(this.contract.depositAndCommit(this.state.activity, distanceInMiles * 100, startTime, stakeAmount, stakeAmount, String(this.props.code.athlete.id), {\n                gasLimit: 5000000\n              }));\n\n            case 10:\n              _context2.next = 16;\n              break;\n\n            case 12:\n              _context2.next = 14;\n              return _regeneratorRuntime.awrap(this.daiContract.approve('0x251B6f95F6A17D2aa350456f616a84b733380eBE', stakeAmount));\n\n            case 14:\n              _context2.next = 16;\n              return _regeneratorRuntime.awrap(this.contract.depositAndCommit(this.state.activity, distanceInMiles * 100, startTime, stakeAmount, stakeAmount, String(this.props.code.athlete.id), {\n                gasLimit: 5000000\n              }));\n\n            case 16:\n              this.setState({\n                loading: false,\n                txSent: true\n              });\n\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"getActivityName\",\n    value: function getActivityName() {\n      var _this2 = this;\n\n      return this.state.activities.find(function (act) {\n        return act.value === _this2.state.activity;\n      }).label;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _Dimensions$get = Dimensions.get('window'),\n          width = _Dimensions$get.width;\n\n      return React.createElement(View, {\n        style: {\n          flex: 1,\n          width: width,\n          alignItems: 'center',\n          justifyContent: 'space-around'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 9\n        }\n      }, this.state.loading ? React.createElement(View, {\n        style: {\n          flex: 1,\n          alignItems: 'center',\n          justifyContent: 'center',\n          position: 'absolute',\n          right: 0,\n          left: 0,\n          top: 0,\n          bottom: 0,\n          backgroundColor: 'rgba(0,0,0,0.5)',\n          zIndex: 2\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 35\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 25\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 214\n        }\n      }, \"\\u231B\")) : undefined, !this.state.txSent ? React.createElement(View, {\n        style: {\n          flex: 1,\n          alignItems: 'center',\n          justifyContent: 'space-around'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: {\n          alignItems: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          color: 'white',\n          fontSize: 30,\n          textAlign: 'center',\n          marginBottom: 25\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 17\n        }\n      }, \"Now that you've connected Strava and have funds in your wallet, you can set up your commitment!\"), React.createElement(Text, {\n        style: {\n          fontSize: 30,\n          color: 'white',\n          marginBottom: 25,\n          textAlign: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }\n      }, \"Create Commitment\"), React.createElement(View, {\n        style: {\n          flexDirection: \"row\",\n          width: 300,\n          padding: 10,\n          zIndex: 5000\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 25\n        }\n      }, \"Activity:\"), React.createElement(DropDownPicker, {\n        items: this.state.activities,\n        containerStyle: {\n          height: 40\n        },\n        style: {\n          backgroundColor: '#fafafa',\n          width: 135\n        },\n        itemStyle: {\n          justifyContent: 'flex-start'\n        },\n        dropDownStyle: {\n          backgroundColor: '#fafafa'\n        },\n        onChangeItem: function onChangeItem(item) {\n          console.log(\"change\", item);\n\n          _this3.setState({\n            activity: item.value\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 25\n        }\n      })), React.createElement(View, {\n        style: {\n          flexDirection: \"row\",\n          width: 300,\n          padding: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 25\n        }\n      }, \"Distance:\"), React.createElement(View, {\n        style: {\n          flex: 1,\n          flexDirection: 'row',\n          marginLeft: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 25\n        }\n      }, React.createElement(TextInput, {\n        style: {\n          textAlign: 'center',\n          borderRadius: 5,\n          backgroundColor: 'white',\n          fontSize: 28,\n          color: 'black',\n          width: 30 + '%'\n        },\n        onChangeText: function onChangeText(text) {\n          return _this3.setState({\n            distance: Number(text)\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 29\n        }\n      }), React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 234\n        }\n      }, \" Miles\"))), React.createElement(View, {\n        style: {\n          flexDirection: \"row\",\n          width: 300,\n          padding: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 25\n        }\n      }, \"Stake:\"), React.createElement(View, {\n        style: {\n          flex: 1,\n          flexDirection: 'row',\n          marginLeft: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 25\n        }\n      }, React.createElement(TextInput, {\n        style: {\n          textAlign: 'center',\n          borderRadius: 5,\n          backgroundColor: 'white',\n          fontSize: 28,\n          color: 'black',\n          width: 30 + '%'\n        },\n        onChangeText: function onChangeText(text) {\n          return _this3.setState({\n            stake: Number(text)\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 29\n        }\n      }), React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 231\n        }\n      }, \" Dai\"))), React.createElement(View, {\n        style: {\n          flexDirection: \"row\",\n          width: 300,\n          padding: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 25\n        }\n      }, \"Deadline:\"), React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          marginLeft: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 25\n        }\n      }, \"2 Days\"))), React.createElement(TouchableOpacity, {\n        style: {\n          width: 300,\n          height: 50,\n          backgroundColor: '#D45353',\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        onPress: function onPress() {\n          return _this3.createCommitment();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 30,\n          color: 'white'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 21\n        }\n      }, \"Stake and Commit\"))) : React.createElement(View, {\n        style: {\n          backgroundColor: '#D45353',\n          flex: 1,\n          alignItems: 'center',\n          justifyContent: 'space-around'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 13\n        }\n      }, this.state.loading ? React.createElement(View, {\n        style: {\n          alignItems: 'center',\n          justifyContent: 'center',\n          position: 'absolute',\n          right: 0,\n          left: 0,\n          top: 0,\n          bottom: 0,\n          backgroundColor: 'rgba(0,0,0,0.5)',\n          zIndex: 2\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 39\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 25\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 209\n        }\n      }, \"\\u231B\")) : undefined, React.createElement(View, {\n        style: {\n          alignItems: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 50,\n          color: 'white',\n          marginBottom: 25,\n          textAlign: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 21\n        }\n      }, \"Commitment Created\"), React.createElement(Text, {\n        style: {\n          fontSize: 50,\n          marginBottom: 25\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 21\n        }\n      }, \"\\u2714\\uFE0F\"), React.createElement(View, {\n        style: {\n          flexDirection: \"row\",\n          width: 300,\n          padding: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 25\n        }\n      }, \"Activity:\"), React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          marginLeft: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 25\n        }\n      }, this.getActivityName())), React.createElement(View, {\n        style: {\n          flexDirection: \"row\",\n          width: 300,\n          padding: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 25\n        }\n      }, \"Distance:\"), React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          marginLeft: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 25\n        }\n      }, this.state.distance, \" Miles\")), React.createElement(View, {\n        style: {\n          flexDirection: \"row\",\n          width: 300,\n          padding: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 25\n        }\n      }, \"Stake:\"), React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          marginLeft: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 25\n        }\n      }, this.state.stake, \" Dai\")), React.createElement(View, {\n        style: {\n          flexDirection: \"row\",\n          width: 300,\n          padding: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          fontWeight: 'bold'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 25\n        }\n      }, \"Deadline:\"), React.createElement(Text, {\n        style: {\n          flex: 1,\n          color: 'white',\n          fontSize: 28,\n          marginLeft: 10\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 25\n        }\n      }, \"2 Days\")), React.createElement(Text, {\n        style: {\n          color: 'white',\n          fontSize: 30,\n          marginTop: 25\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 21\n        }\n      }, \"View on Etherscan \", React.createElement(Image, {\n        style: {\n          width: 20,\n          height: 20\n        },\n        source: require(\"./assets/arrow-popout.svg\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 99\n        }\n      }))), React.createElement(TouchableOpacity, {\n        style: {\n          width: 300,\n          height: 50,\n          backgroundColor: '#D45353',\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        onPress: function onPress() {\n          return _this3.props.next(7);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 30,\n          color: 'white'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 21\n        }\n      }, \"Track Progress\"))));\n    }\n  }]);\n\n  return MakeCommitment;\n}(Component);\n\nexport { MakeCommitment as default };","map":{"version":3,"sources":["/Users/ken/dev/CommitPoolMatic/CommitPoolApp/MakeCommitment.tsx"],"names":["React","Component","ethers","utils","abi","daiAbi","DropDownPicker","MakeCommitment","props","state","distance","stake","loading","txSent","activity","activities","url","provider","providers","JsonRpcProvider","privateKey","account","signingKey","wallet","Wallet","connect","contractAddress","contract","Contract","daiAddress","daiContract","exists","index","activityKeyList","key","clone","push","console","log","formattedActivities","map","act","label","value","setState","distanceInMiles","Math","floor","startTime","ceil","Date","getTime","stakeAmount","parseEther","toString","allowance","address","gte","depositAndCommit","String","code","athlete","id","gasLimit","approve","find","Dimensions","get","width","flex","alignItems","justifyContent","position","right","left","top","bottom","backgroundColor","zIndex","fontSize","undefined","color","textAlign","marginBottom","flexDirection","padding","fontWeight","height","item","marginLeft","borderRadius","text","Number","createCommitment","getActivityName","marginTop","require","next"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { View, StyleSheet, Image, Text, Button, TouchableOpacity, TextInput } from \"react-native\";\nimport { ethers, utils } from 'ethers';\nimport abi from './abi.json'\nimport daiAbi from './daiAbi.json'\nimport { Dimensions } from 'react-native';\nimport DropDownPicker from 'react-native-dropdown-picker';\n\nexport default class MakeCommitment extends Component <{next: any, account: any, code: any}, {txSent: Boolean, loading: Boolean, distance: Number, stake: Number, activity: {}, activities: any}> {\n  contract: any;\n  daiContract: any;\n  constructor(props) {\n    super(props);\n    \n    this.state = {\n      distance: 0,\n      stake: 0,\n      loading: false,\n      txSent: false,\n      activity: {},\n      activities: []\n    };\n  }\n\n  async componentDidMount() {\n    const url = 'https://rpc-mumbai.maticvigil.com/v1/e121feda27b4c1387cd0bf9a441e8727f8e86f56'\n\n    const provider = new ethers.providers.JsonRpcProvider(url);\n    \n    let privateKey = this.props.account.signingKey.privateKey;\n    let wallet = new ethers.Wallet(privateKey);\n    \n    wallet = wallet.connect(provider);\n    \n    let contractAddress = '0x251B6f95F6A17D2aa350456f616a84b733380eBE';\n    let contract = new ethers.Contract(contractAddress, abi, provider);\n\n    let daiAddress = '0x70d1f773a9f81c852087b77f6ae6d3032b02d2ab';\n    let daiContract = new ethers.Contract(daiAddress, daiAbi, provider);\n    \n    this.contract = contract.connect(wallet);\n    this.daiContract = daiContract.connect(wallet);\n\n\n    let activities = [];\n    let exists = true;\n    let index = 0;\n\n    while (exists){\n      try {\n        const key = await this.contract.activityKeyList(index);\n        const activity = await this.contract.activities(key);\n        const clone = Object.assign({}, activity)\n        clone.key = key;\n        activities.push(clone);\n        index++;\n      } catch (error) {\n        console.log(error)\n        exists = false;\n      }\n    }\n\n    const formattedActivities = activities.map(act => {\n      if(act[0] === 'Run') {\n        return {\n          label: 'Run üèÉ‚Äç‚ôÇÔ∏è',\n          value: act.key\n        }\n      } else if (act[0] === 'Ride') {\n        return {\n          label: 'Ride üö≤',\n          value: act.key\n        }\n      } else {\n        return {\n          label: act[0],\n          value: act.key\n        }\n      }\n    })\n\n    this.setState({activities: formattedActivities, activity: formattedActivities[0]})\n  }\n\n  async createCommitment() {    \n    const distanceInMiles = Math.floor(this.state.distance);\n    const startTime = Math.ceil(new Date().getTime() / 1000) + 60;\n    const stakeAmount = utils.parseEther(this.state.stake.toString());\n    this.setState({loading: true})\n    \n    const allowance = await this.daiContract.allowance(this.props.account.signingKey.address, '0x251B6f95F6A17D2aa350456f616a84b733380eBE');\n    if(allowance.gte(stakeAmount)) {\n      await this.contract.depositAndCommit(this.state.activity, distanceInMiles * 100, startTime, stakeAmount, stakeAmount, String(this.props.code.athlete.id), {gasLimit: 5000000});\n    } else {\n      await this.daiContract.approve('0x251B6f95F6A17D2aa350456f616a84b733380eBE', stakeAmount)\n      await this.contract.depositAndCommit(this.state.activity, distanceInMiles * 100, startTime, stakeAmount, stakeAmount, String(this.props.code.athlete.id), {gasLimit: 5000000});\n    }\n\n    this.setState({loading: false, txSent: true})\n  }\n\n\n  getActivityName() {\n    return this.state.activities.find((act: any) => act.value === this.state.activity).label;\n  }\n\n  render() {\n\n    const { width } = Dimensions.get('window');\n\n    return (\n        <View style={{flex: 1, width, alignItems: 'center', justifyContent: 'space-around'}}>\n            {this.state.loading ? <View style={{flex: 1, alignItems: 'center', justifyContent: 'center', position: 'absolute', right: 0, left: 0, top: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.5)', zIndex: 2}}><Text style={{fontSize: 25}}>‚åõ</Text></View> : undefined}\n            {!this.state.txSent ? \n            <View style={{flex: 1, alignItems: 'center', justifyContent: 'space-around'}}>\n                <View style={{alignItems: 'center'}}>\n                <Text style={{ color: 'white', fontSize: 30, textAlign: 'center', marginBottom: 25}}>\n               {\"Now that you've connected Strava and have funds in your wallet, you can set up your commitment!\"} \n            </Text>\n                    <Text style={{fontSize: 30, color: 'white', marginBottom: 25, textAlign: 'center'}}>Create Commitment</Text>\n                    <View style={{flexDirection: \"row\", width: 300, padding: 10, zIndex: 5000}}>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, fontWeight: 'bold'}}>Activity:</Text>\n                        <DropDownPicker\n                            items={this.state.activities}\n                            containerStyle={{height: 40}}\n                            style={{backgroundColor: '#fafafa', width: 135}}\n                            itemStyle={{\n                                justifyContent: 'flex-start'\n                            }}\n                            dropDownStyle={{backgroundColor: '#fafafa'}}\n                            onChangeItem={item => {\n                                console.log(\"change\", item)\n                                this.setState({activity: item.value})\n                            }}\n                        />\n                    </View>\n                    <View style={{flexDirection: \"row\", width: 300, padding: 10}}>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, fontWeight: 'bold'}}>Distance:</Text>\n                        <View style={{flex: 1, flexDirection: 'row', marginLeft: 10}}>\n                            <TextInput style={{textAlign:'center', borderRadius: 5, backgroundColor: 'white', fontSize: 28, color: 'black', width: 30 + '%'}} onChangeText={text => this.setState({distance: Number(text)})}></TextInput><Text style={{flex: 1, color: 'white', fontSize: 28}}> Miles</Text>\n                        </View>                    \n                    </View>\n                    <View style={{flexDirection: \"row\", width: 300, padding: 10}}>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, fontWeight: 'bold'}}>Stake:</Text>\n                        <View style={{flex: 1, flexDirection: 'row', marginLeft: 10}}>\n                            <TextInput style={{textAlign:'center', borderRadius: 5, backgroundColor: 'white', fontSize: 28, color: 'black', width: 30 + '%'}} onChangeText={text => this.setState({stake: Number(text)})}></TextInput><Text style={{flex: 1, color: 'white', fontSize: 28}}> Dai</Text>\n                        </View>\n                    </View>\n                    <View style={{flexDirection: \"row\", width: 300, padding: 10}}>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, fontWeight: 'bold'}}>Deadline:</Text>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, marginLeft: 10}}>2 Days</Text>\n                    </View>\n                </View>\n\n                <TouchableOpacity\n                        style={{width: 300, height: 50, backgroundColor: '#D45353', alignItems: 'center', justifyContent: 'center'}}\n                        onPress={() => this.createCommitment()}>\n                    <Text style={{fontSize: 30, color: 'white'}}>Stake and Commit</Text>\n                </TouchableOpacity>\n            </View>\n            :\n            <View style={{backgroundColor: '#D45353', flex: 1, alignItems: 'center', justifyContent: 'space-around'}}>\n                {this.state.loading ? <View style={{alignItems: 'center', justifyContent: 'center', position: 'absolute', right: 0, left: 0, top: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.5)', zIndex: 2}}><Text style={{fontSize: 25}}>‚åõ</Text></View> : undefined}\n                <View style={{alignItems: 'center'}}>\n                    <Text style={{fontSize: 50, color: 'white', marginBottom: 25, textAlign: 'center'}}>Commitment Created</Text>\n                    <Text style={{fontSize: 50, marginBottom: 25}}>‚úîÔ∏è</Text>\n                    <View style={{flexDirection: \"row\", width: 300, padding: 10}}>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, fontWeight: 'bold'}}>Activity:</Text>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, marginLeft: 10}}>{this.getActivityName()}</Text>\n                    </View>\n                    <View style={{flexDirection: \"row\", width: 300, padding: 10}}>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, fontWeight: 'bold'}}>Distance:</Text>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, marginLeft: 10}}>{this.state.distance} Miles</Text>                 \n                    </View>\n                    <View style={{flexDirection: \"row\", width: 300, padding: 10}}>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, fontWeight: 'bold'}}>Stake:</Text>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, marginLeft: 10}}>{this.state.stake} Dai</Text>\n                    </View>\n                    <View style={{flexDirection: \"row\", width: 300, padding: 10}}>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, fontWeight: 'bold'}}>Deadline:</Text>\n                        <Text style={{flex: 1, color: 'white', fontSize: 28, marginLeft: 10}}>2 Days</Text>\n                    </View>\n                    <Text style={{color: 'white', fontSize: 30, marginTop: 25}}>View on Etherscan <Image style={{width: 20, height: 20}} source={require('./assets/arrow-popout.svg')}></Image></Text>\n                </View>\n\n                <TouchableOpacity\n                        style={{width: 300, height: 50, backgroundColor: '#D45353', alignItems: 'center', justifyContent: 'center'}}\n                        onPress={() => this.props.next(7)}>\n                    <Text style={{fontSize: 30, color:'white'}}>Track Progress</Text>\n                </TouchableOpacity>\n            </View>}\n        </View>\n        \n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}